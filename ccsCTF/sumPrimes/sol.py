from Crypto.Util.number import *
from sympy import symbols, solve
import math

n = 16788495201134488862439912856049193220030278791354407824091058891523572744299248977833678682180477201647948765071660121057955696605397496906679177141708293872331509832259003894358384151329645906327830246642602128616234497738787884343156900722929131121218452194252346908503936663757356350508850451699077967575285190792659520158125849301396420685523555640685730988764615970908655059092180105081055484998287858215803938408438983416015169710019871911075533366970454688997863136022756821285744932502497706252885713734508465511544260174182376059836188512289623484680215854076270456300882895460108607189426367528331288540003
e = 65537
c = 3113702954534549466067193908939459013918374705219282681446905528104780133113124552950513897583286374704896994808648102303595961668163034845453876468895227031006013103266978002947573831473084007495587342222690825713484168015683050974873352387266370516066894173095196647357958138457261206478528384211141880481493176027789185410939906004322716944855215007460881386120336014253460550774729793941790263355944622385807768854744915308051181020710674926789107263962800783694924490590759453384689842498365736034411357166529327246470394029708912556431773467111329244573076367645120614697030254122742880650053185783689280216346
xD = 261702323871427311695190970783950657602079466413731256055001109648960372842737741695448840642967686014986541573025865190473552653588658039414899771010532521875674332352964613761456896961477736523199338463156622671659732847894818578728546035481269038398247435219839979565799813899296075408380253795048337758356

x = symbols('x')
roots = solve(x**2 - xD*x + n, x)
p = int(roots[0])
q = int(roots[1])

phi = (p - 1) * (q - 1)
d = inverse(e, phi)

m = pow(c, d, n)

flag = long_to_bytes(m)
print(flag.decode())

# OUTPUT : ccsCTF{p-deer-q-g-nemeed-n-eesee-hasaad-negiig-nemchuul-tentsu-phi-um-bna-xD}
